IF (
    FIND(" ", SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)=0, UPPER(LEFT({!$Record.LastName} ,1))& LOWER(MID({!$Record.LastName},2,LEN({!$Record.LastName})-1)),
        IF(
            FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.LastName})-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " "),1)))=0,
            UPPER(LEFT({!$Record.LastName} ,1))&LOWER(MID({!$Record.LastName} ,2,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)-1))&UPPER(MID({!$Record.LastName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.LastName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+2,LEN({!$Record.LastName})-1)),
            UPPER(LEFT({!$Record.LastName} ,1))&LOWER(MID({!$Record.LastName} ,2,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)-1))&UPPER(MID({!$Record.LastName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.LastName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+2,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.LastName} )-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)))-1))&
            UPPER(MID({!$Record.LastName} ,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.LastName})-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)))+FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.LastName} ,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.LastName} )-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)))+FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.LastName}, "-", " "), "'", " ") ,1)+2,LEN({!$Record.LastName})-1))
)
)