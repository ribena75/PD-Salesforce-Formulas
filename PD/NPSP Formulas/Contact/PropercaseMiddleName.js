IF (
    FIND(" ", SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)=0, UPPER(LEFT({!$Record.MiddleName} ,1))& LOWER(MID({!$Record.MiddleName},2,LEN({!$Record.MiddleName})-1)),
        IF(
            FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.MiddleName})-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " "),1)))=0,
            UPPER(LEFT({!$Record.MiddleName} ,1))&LOWER(MID({!$Record.MiddleName} ,2,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)-1))&UPPER(MID({!$Record.MiddleName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.MiddleName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+2,LEN({!$Record.MiddleName})-1)),
            UPPER(LEFT({!$Record.MiddleName} ,1))&LOWER(MID({!$Record.MiddleName} ,2,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)-1))&UPPER(MID({!$Record.MiddleName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.MiddleName} ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+2,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.MiddleName} )-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)))-1))&
            UPPER(MID({!$Record.MiddleName} ,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.MiddleName})-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)))+FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,1))&LOWER(MID({!$Record.MiddleName} ,FIND(" ",MID(SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+1,LEN({!$Record.MiddleName} )-FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)))+FIND(" ",SUBSTITUTE(SUBSTITUTE({!$Record.MiddleName}, "-", " "), "'", " ") ,1)+2,LEN({!$Record.MiddleName})-1))
)
)